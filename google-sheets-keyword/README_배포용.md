# 키워드 자동 분류 도구 (배포용)

구글 시트에서 카페 키워드를 자동으로 필터링하고 정렬하는 도구입니다.

## 주요 기능

### 1. 📥 데이터 변환 (입력→출력)
- A열 빈칸에 위의 검색키워드 자동 채우기
- **카페가 있는 키워드만 필터링**
- 검색키워드 중복 시 상단 그룹만 유지
- 카페 개수 많은 순으로 정렬 (3개 > 2개 > 1개)

### 2. 🔄 데이터 재배열 (카페 우선)
- 이미 변환된 데이터를 다시 정렬
- 검색키워드별로 그룹화
- 카페가 없는 키워드 제거
- 카페 개수 많은 순으로 정렬

### 3. 🗑️ 중복 제거
- A열 키워드 기준으로 중복된 행 삭제
- 가장 위에 있는 행만 유지

## 설치 방법

### 1단계: Apps Script 열기
1. 구글 시트 열기
2. 상단 메뉴: **확장 프로그램 > Apps Script**

### 2단계: 코드 붙여넣기
1. 기존 코드 전체 삭제
2. [Code_Public.js](Code_Public.js) 파일 내용 전체 복사
3. Apps Script 편집기에 붙여넣기
4. **저장** (Ctrl+S 또는 💾 아이콘)

### 3단계: 시트로 돌아가기
1. 구글 시트 탭으로 돌아가기
2. **새로고침** (F5)
3. 상단에 **"키워드 도구"** 메뉴 표시됨

### 4단계: 권한 승인 (최초 1회만)
1. 메뉴 클릭 시 권한 요청 팝업 표시
2. **"권한 검토"** 클릭
3. 구글 계정 선택
4. **"고급"** → **"안전하지 않은 페이지로 이동"** 클릭
5. **"허용"** 클릭

## 사용 방법

### 📥 데이터 변환

#### 입력 형식
```
A열: 검색키워드 (빈칸 가능)
B열: 주제키워드
C~E열: 콘텐츠영역 (카페, 블로그 등)
```

#### 예시 입력
```
검색키워드 | 주제키워드        | 콘텐츠1 | 콘텐츠2 | 콘텐츠3
대상포진   | 대상포진 초기증상 | 카페    | 블로그  | 블로그
           | 대상포진 치료법   | 블로그  | 블로그  | 블로그
           | 대상포진 병원     | 카페    | 카페    | 블로그
```

#### 출력 형식
```
검색키워드 | PC | M | 주제키워드        | 콘텐츠1 | 콘텐츠2 | 콘텐츠3
대상포진   |    |   | 대상포진 병원     | 카페    | 카페    | 블로그
대상포진   |    |   | 대상포진 초기증상 | 카페    | 블로그  | 블로그
```
*※ 카페 3개 > 2개 > 1개 순으로 자동 정렬*
*※ 블로그만 있는 키워드는 자동 제거*

### 🔄 데이터 재배열

이미 변환된 데이터(A~G열)를 다시 정렬합니다.

1. **키워드 도구 > 🔄 데이터 재배열** 클릭
2. 확인 메시지에서 **YES** 클릭
3. 카페 우선으로 자동 재정렬

### 🗑️ 중복 제거

A열 키워드 기준으로 중복 행을 삭제합니다.

1. **키워드 도구 > 중복 제거** 클릭
2. 확인 메시지에서 **YES** 클릭
3. 중복 행 자동 삭제 (위에 있는 행만 유지)

## 주의사항

### PC/M 검색량 조회 기능 제외
- 네이버 검색광고 API가 필요하므로 배포용에서는 제외되었습니다
- 검색량은 별도로 입력하거나, 네이버 키워드 도구를 이용하세요

### 데이터 백업
- 작업 전 시트를 복사해두는 것을 권장합니다
- **파일 > 사본 만들기**로 백업 가능

### 카페 필터링
- 콘텐츠 영역(C~E열 또는 E~G열)에 "카페" 텍스트가 1개 이상 있어야 합니다
- 블로그만 있는 키워드는 자동으로 제거됩니다

## 문제 해결

### 메뉴가 보이지 않아요
- 시트를 새로고침(F5) 해보세요
- Apps Script에서 코드를 저장했는지 확인하세요

### "권한이 필요합니다" 메시지가 나와요
- 최초 실행 시 정상적인 메시지입니다
- 위의 **4단계: 권한 승인** 절차를 따라하세요

### 오류가 발생해요
- 데이터 형식이 올바른지 확인하세요
- 1행은 헤더, 2행부터 데이터가 있어야 합니다
- Apps Script 실행 로그를 확인해보세요

## 라이선스

이 코드는 자유롭게 사용, 수정, 배포할 수 있습니다.

## 제작자

구글 시트 키워드 자동 분류 도구 v1.0 (2025)
